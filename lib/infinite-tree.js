!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("element-ui/lib/button"),require("infinite-ui/lib/utils/index"),require("element-ui/lib/input"),require("element-ui/lib/tree"),require("element-ui/lib/message"));else if("function"==typeof define&&define.amd)define(["element-ui/lib/button","infinite-ui/lib/utils/index","element-ui/lib/input","element-ui/lib/tree","element-ui/lib/message"],t);else{var i="object"==typeof exports?t(require("element-ui/lib/button"),require("infinite-ui/lib/utils/index"),require("element-ui/lib/input"),require("element-ui/lib/tree"),require("element-ui/lib/message")):t(e["element-ui/lib/button"],e["infinite-ui/lib/utils/index"],e["element-ui/lib/input"],e["element-ui/lib/tree"],e["element-ui/lib/message"]);for(var n in i)("object"==typeof exports?exports:e)[n]=i[n]}}(window,(function(e,t,i,n,r){return function(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=39)}({0:function(e,t,i){"use strict";function n(e,t,i,n,r,o,a,d){var s,l="function"==typeof e?e.options:e;if(t&&(l.render=t,l.staticRenderFns=i,l._compiled=!0),n&&(l.functional=!0),o&&(l._scopeId="data-v-"+o),a?(s=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),r&&r.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(a)},l._ssrRegister=s):r&&(s=d?function(){r.call(this,(l.functional?this.parent:this).$root.$options.shadowRoot)}:r),s)if(l.functional){l._injectStyles=s;var u=l.render;l.render=function(e,t){return s.call(t),u(e,t)}}else{var c=l.beforeCreate;l.beforeCreate=c?[].concat(c,s):[s]}return{exports:e,options:l}}i.d(t,"a",(function(){return n}))},1:function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-button",{staticClass:"infinite-button",attrs:{disabled:e.disabled,plain:e.plain,round:e.round,circle:e.circle,size:e.size,type:e.type},on:{click:e.handleClick}},[e.icon?i("i",{class:e.icon}):e._e(),e._v(" "),e.$slots.default?[e._t("default")]:e._e()],2)};n._withStripped=!0;var r=i(2),o={name:"InfiniteButton",components:{ElButton:i.n(r).a},props:{type:{type:String,default:"default"},plain:{type:Boolean},round:{type:Boolean,default:!1},circle:{type:Boolean,default:!1},disabled:{type:Boolean},icon:{type:String,default:""},size:{type:String,default:"small"}},methods:{recursionSetBtnRmFocus:function(e){"BUTTON"===e.nodeName?e.blur():this.recursionSetBtnRmFocus(e.parentNode)},handleClick:function(e){this.recursionSetBtnRmFocus(e.target),this.$emit("click",e)}}},a=i(0),d=Object(a.a)(o,n,[],!1,null,null,null);d.options.__file="packages/infinite-button/src/index.vue";t.a=d.exports},2:function(t,i){t.exports=e},3:function(e,i){e.exports=t},30:function(e,t){e.exports=n},31:function(e,t){e.exports=r},39:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"infinite-tree "},[i("el-tree",e._g(e._b({ref:"infiniteTreeRef",class:{"in-tree-line":e.treeLine,"in-show-checkbox":e.$attrs["show-checkbox"]},attrs:{props:e.props,"node-key":e.nodeKey,indent:0,"expand-on-click-node":!e.operationNode,draggable:!e.operationNode&&e.draggable},on:{"node-expand":e.nodeExpand,"node-drag-start":e.nodeDragStart,"node-drag-end":e.nodeDragEnd,"node-drag-enter":e.nodeDragEnter,"node-click":e.nodeClick,"node-drop":e.nodeDrop},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.node,r=t.data;return i("div",{staticClass:"custom-tree-node",class:{node_editing:r&&r[e.nodeKey]===(e.operationNode?e.operationNode.data[e.nodeKey]:"")}},[r["in-input-type"]?e._e():i("div",{staticClass:"custom-tree-node-text",class:{"highlight-node":e.highlightNodeMap[r[e.nodeKey]]}},[e._t("default",[e._l(e.editInputs,(function(t,i){return[i&&r[t.id||e.props.label]?[e._v(" ("+e._s(r[t.id||e.props.label])+")")]:[e._v(e._s(r[t.id||e.props.label]))]]}))],null,{node:n,data:r})],2),e._v(" "),e.moving||!e.isEditNode||r["in-input-type"]?"input"===r["in-input-type"]&&e.isEditNode?i("div",{staticClass:"editing__content"},[e._l(e.editInputs,(function(t,r){return i("div",{directives:[{name:"show",rawName:"v-show",value:!t.hidden,expression:"!item.hidden"}],key:r,staticClass:"editing__content-group_inputs"},[i("el-input",{attrs:{disabled:t.disabled,size:e.editComponentSize,placeholder:t.placeholder},on:{input:function(i){return e.validateInput(t,n)}},model:{value:e.editInputMap[t.id].value,callback:function(i){e.$set(e.editInputMap[t.id],"value","string"==typeof i?i.trim():i)},expression:"editInputMap[item.id].value"}}),e._v(" "),i("div",{staticClass:"group_inputs-vilidate-error"},[e._v("\n            "+e._s(t.validateFun&&e.editInputMap[t.id].validateError)+"\n          ")])],1)})),e._v(" "),i("div",{staticClass:"operation-group-btn"},e._l(e.editNodeOperationBtn,(function(t,o){return i("infinite-button",{key:o,staticClass:"btn-text",class:t.class,attrs:{type:t.type},on:{click:function(e){return e.stopPropagation(),t.click(r,n)}}},[e._v(e._s(t.label))])})),1)],2):e._e():i("div",{staticClass:"tree-edit-btns"},e._l(e.nodeOperationBtn,(function(t,o){return i("i",{directives:[{name:"show",rawName:"v-show",value:e.assignOperationBtnsProp[t.id].beforeCreate(n),expression:"assignOperationBtnsProp[btn.id].beforeCreate(node)"}],key:o,class:e.assignOperationBtnsProp[t.id].icon,on:{click:function(e){return e.stopPropagation(),t.click(r,n)}}})})),0)])}}],null,!0)},"el-tree",e.$attrs,!1),e.$listeners))],1)};n._withStripped=!0;var r=i(30),o=i.n(r),a=i(4),d=i.n(a),s=i(31),l=i.n(s);function u(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var c=new(function(){function e(){var t,i,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n=1e4,(i="tempId")in(t=this)?Object.defineProperty(t,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[i]=n}var t,i,n;return t=e,(i=[{key:"createNode",value:function(e){return{id:"tempin-".concat(this.tempId++),"in-input-type":"input",outer:!0}}},{key:"isAddCancel",value:function(e){return e.id.toString().includes("temp")}}])&&u(t.prototype,i),n&&u(t,n),e}()),f=i(3);function p(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function h(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var g={props:{props:{type:Object,default:function(){return{children:"children",label:"label"}}},nodeKey:{type:String,default:"id"},draggable:{type:Boolean,default:!1},isAutoExpandChildren:{type:Boolean,default:!0},isEditNode:{type:Boolean,default:!1},editComponentSize:{type:String,default:"mini"},treeLine:{type:Boolean,default:!0},editInputs:{type:Array,default:function(){return[{id:"label",placeholder:"请输入节点名称",sameNameError:"节点名称重复",validateFun:function(e){return e?"":"节点名称不能为空"}}]}},nodeOperationBtnsProp:{type:Object,default:function(){return{}}},sameOperationError:{type:String,default:"请先完成当前操作"},beforeDelete:{type:Function,default:function(){return!0}},beforeAdd:{type:Function,default:function(){return!0}},beforeEdit:{type:Function,default:function(){return!0}}},methods:{remove:function(e){this.$refs.infiniteTreeRef.remove(e),this.addNotChildrenNodeAttr()},append:function(e,t){this.$refs.infiniteTreeRef.append(e,t),this.addNotChildrenNodeAttr()},insertBefore:function(e,t){this.$refs.infiniteTreeRef.insertBefore(e,t),this.addNotChildrenNodeAttr()},insertAfter:function(e,t){this.$refs.infiniteTreeRef.insertAfter(e,t),this.addNotChildrenNodeAttr()},setHighlightNode:function(e){var t=this,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e?Array.isArray(e)?e.forEach((function(e){t.$set(t.highlightNodeMap,e,i)})):this.$set(this.highlightNodeMap,e,i):Object.keys(this.highlightNodeMap).forEach((function(e){t.$set(t.highlightNodeMap,e,i)}))},addNotChildrenNodeAttr:function(){var e=this;this.$nextTick((function(){var t=e.$refs.infiniteTreeRef.$el.querySelectorAll(".el-tree-node");Array.from(t).forEach((function(e){var t=e.querySelector(".el-tree-node__children");e.setAttribute("not-children",null===t||""===t.innerHTML)}))}))},nodeExpand:function(){this.addNotChildrenNodeAttr()},validateInput:function(e,t){var i=this.editInputMap[e.id];i.validateError=e.validateFun?e.validateFun(i.value,t):""},clearRecordNode:function(){this.operationNode=null,this.peerOperationNodes=null},isInOperation:function(e){if(this.operationNode)return this.$message.closeAll(),void this.$message.error(this.sameOperationError);e&&e()},editOver:function(e,t){var i=this;this.$delete(e,"in-input-type"),t&&(this.editInputs.forEach((function(t){e[t.id]=i.editInputMap[t.id].value})),"string"==typeof e[this.nodeKey]&&(e[this.nodeKey]=e[this.nodeKey].replace("temp",""))),this.clearRecordNode()},addNode:function(e,t){var i=this;if(this.beforeAdd(t)){this.editInputs.forEach((function(e){var t=i.editInputMap[e.id];t.value=e.defaultValue||"",t.validateError=""}));var n=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?p(Object(i),!0).forEach((function(t){h(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):p(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({},c.createNode());this.editInputs.forEach((function(e){n[e.id]=""}));var r=e?t:this.$refs.infiniteTreeRef.root,o=r.childNodes[0];o?this.insertBefore(n,o):this.append(n,r),this.peerOperationNodes=r.childNodes,this.operationNode=r.childNodes[0],e&&(t.expanded=!0),this.$emit("addNode",e||r)}},addRootNode:function(){var e=this;this.isInOperation((function(){e.addNode()}))},cancelNode:function(e,t){c.isAddCancel(e)?this.delSelect(t,!1):this.editOver(e)},editNode:function(e,t){var i=this;this.beforeEdit(t)&&(this.$set(e,"in-input-type","input"),this.editInputs.forEach((function(t,n){var r=i.editInputMap[t.id];r.value=e[t.id],r.validateError=""})),this.operationNode=t,this.$emit("editNode",e))},confirmNode:function(e,t){var i=this,n=!1;this.editInputs.forEach((function(e){var r=i.editInputMap[e.id];e.validateFun&&!e.hidden&&(r.validateError=e.validateFun(r.value,t),r.validateError&&(n=!0))})),n||(this.editInputs.forEach((function(r){if(r.sameNameError&&!r.hidden&&!n){var o=i.editInputMap[r.id],a=[];r.sameNameValiMode&&"local"!==r.sameNameValiMode?"overall"===r.sameNameValiMode&&(a=Object(f.jsonFlat)(i.$refs.infiniteTreeRef.root.data)):a=t.parent.data[i.props.children]||t.parent.data;for(var d=0;d<a.length;d++){var s=a[d];if(s[r.id]===o.value&&s[i.nodeKey]!==e[i.nodeKey]){o.validateError=r.sameNameError,n=!0;break}}}})),n||(this.editOver(e,!0),this.$emit("handlerSave",e)))},delSelect:function(e,t){this.beforeDelete(e)&&(this.dustbin={parent:e.parent,nextSibling:e.nextSibling,previousSibling:e.previousSibling,data:e.data},this.remove(e),this.clearRecordNode(),t&&this.$emit("handlerDelete",e.data))},revocationDel:function(e){if(e||this.dustbin){var t=e||this.dustbin,i=t.parent,n=t.data,r=t.nextSibling,o=t.previousSibling;r?this.insertBefore(n,r):o?this.insertAfter(n,o):this.append(n,i)}this.dustbin=null}}},v={methods:{nodeDragStart:function(e){this.moving=!0,this.dragSuccess=!1,this.draggNode={parent:e.parent,nextSibling:e.nextSibling,previousSibling:e.previousSibling,data:e.data}},nodeDragEnd:function(){this.moving=!1},nodeDragEnter:function(e,t){this.isAutoExpandChildren&&(this.dragTimer&&clearTimeout(this.dragTimer),this.dragTimer=setTimeout((function(e){t.expanded=!0}),1e3))},nodeDrop:function(e){this.dragSuccess=!0,this.setHighlightNode(null,!1),this.setHighlightNode(e.data.id)},nodeClick:function(){this.draggable&&this.setHighlightNode(null,!1)},revocationDrag:function(){this.dragSuccess&&this.draggNode&&(this.remove(this.draggNode.data),this.dustbin=null,this.revocationDel(this.draggNode),this.draggNode=null,this.dragSuccess=!1)}}},b=i(1),m={name:"InfiniteTree",mixins:[g,v],inheritAttrs:!1,components:{ElTree:o.a,ElInput:d.a,InfiniteButton:b.a},beforeCreate:function(){this.$message=l.a},computed:{assignOperationBtnsProp:function(){var e=this,t={};return this.nodeOperationBtn.forEach((function(i){var n={beforeCreate:function(){return!0},icon:i.icon};t[i.id]=e.nodeOperationBtnsProp[i.id]?Object.assign(n,e.nodeOperationBtnsProp[i.id]):n})),t}},data:function(){var e=this;return{dustbin:{peerDatas:null,data:null,index:0},highlightNodeMap:{},dragTimer:null,draggNode:null,moving:!1,dragSuccess:!1,editInputMap:[],operationNode:null,peerOperationNodes:null,editNodeOperationBtn:[{class:"operation-confirm",label:"确定",type:"text",click:function(t,i){e.confirmNode(t,i)}},{class:"operation-cancel",label:"取消",type:"text",click:function(t,i){e.cancelNode(t,i)}}],nodeOperationBtn:[{id:"add",icon:"el-icon-circle-plus-outline",click:function(t,i){e.isInOperation((function(){e.$emit("addNodeBefore",t,i),e.addNode(t,i)}))}},{id:"delete",icon:"el-icon-remove-outline",click:function(t,i){e.isInOperation((function(){e.delSelect(i,!0)}))}},{id:"edit",icon:"el-icon-edit",click:function(t,i){e.isInOperation((function(){e.$emit("editNodeBefore",t,i),e.editNode(t,i)}))}}]}},watch:{isEditNode:{handler:function(e){var t=this;e&&this.editInputs.forEach((function(e){t.$set(t.editInputMap,e.id,{}),t.$set(t.editInputMap[e.id],"value",""),t.$set(t.editInputMap[e.id],"validateError","")}))},immediate:!0},operationNode:function(){this.$emit("editChange",!!this.operationNode)}},mounted:function(){this.filter=this.$refs.infiniteTreeRef.filter,this.updateKeyChildren=this.$refs.infiniteTreeRef.updateKeyChildren,this.getCheckedNodes=this.$refs.infiniteTreeRef.getCheckedNodes,this.setCheckedNodes=this.$refs.infiniteTreeRef.setCheckedNodes,this.getCheckedKeys=this.$refs.infiniteTreeRef.getCheckedKeys,this.setCheckedKeys=this.$refs.infiniteTreeRef.setCheckedKeys,this.setChecked=this.$refs.infiniteTreeRef.setChecked,this.getHalfCheckedNodes=this.$refs.infiniteTreeRef.getHalfCheckedNodes,this.getHalfCheckedKeys=this.$refs.infiniteTreeRef.getHalfCheckedKeys,this.getCurrentKey=this.$refs.infiniteTreeRef.getCurrentKey,this.getCurrentNode=this.$refs.infiniteTreeRef.getCurrentNode,this.setCurrentKey=this.$refs.infiniteTreeRef.setCurrentKey,this.setCurrentNode=this.$refs.infiniteTreeRef.setCurrentNode,this.getNode=this.$refs.infiniteTreeRef.getNode,this.addNotChildrenNodeAttr()}},y=i(0),N=Object(y.a)(m,n,[],!1,null,null,null);N.options.__file="packages/infinite-tree/src/index.vue";var _=N.exports;_.install=function(e){e.component(_.name,_)};t.default=_},4:function(e,t){e.exports=i}})}));